<br> 
<center><img src="http://i.imgur.com/sSaOozN.png" width="500"></center>

## Course: Visual Analytics for Policy and Management
#
### Final Project: Broadband Internet Access in Stevenson, WA
#
#### By Nathan Anderson-Hobbs, Johnson Nguyen, Kim Pearson & Marcela V?zquez
#
<center><img src="https://i.ibb.co/nBvk8kM/20190313-114801.jpg" width="600"></center>
#

### Background

<center><img src="<a href="https://imgbb.com/"><img src="https://i.ibb.co/VtKFhkX/0118-bridge-of-the-gods-s0001407.jpg" alt="0118-bridge-of-the-gods-s0001407" border="0"></a><br /><a target='_blank' href='https://aluminumsulfate.net/aluminum'>how is aluminium found</a><br />"

Stevenson, WA, is a small town of about 1500 people in the Portland Metropolitan Region. Although the small city features various natural and cultural amenities, many of its residents, businesses, and organizations have expressed dissatisfaction with local internet services. In February 2018, Stevenson City Council directed city staff to pursue the creation of a strategic plan regarding broadband infrastructure. 

Broadband is high-speed internet, or internet with minimum speeds of 25 megabits per second (mbps) downloading and 3 mbps uploading, according to the US Federal Communications Commission (FCC). One of our team members, Kimberly Pearson, when interning at the City of Stevenson as the Broadband Project Coordinator, created a survey to assess current internet quality and uptake for busiesses and organizations. After sending the survey to over 150 small and medium sized businesses within city limits, 40 businesses responded, a ~26% response rate. The results were then visualized in Tableau (see plots below).

###### Original plots: https://public.tableau.com/profile/kimberly.pearson#!/vizhome/StevensonBusinessSurvey/Story1

### Univariate Plots

```{r message=FALSE, warning=FALSE}
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet.RData'
load(file=url(link))

library(ggplot2)

box1 = ggplot(Internet, aes(x = ISP, y=Download.Speed))
box2 = box1 + geom_boxplot(color='black',fill='white',
                           outlier.color='black',
                           outlier.size=2) + coord_flip()
                           
box3 = box2 + labs(title='Wave provides highest range of download speeds', subtitle = 'Stevenson, WA',
                   y = 'Download Speed (Megabytes/Second)',
                   x = NULL,
                   caption = 'Source: Stevenson Business and Organization Internet Survey 
                   Note: Wave Outlier of 500 Mbps Omitteed')

box4 = box3 + theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5)),
                    plot.caption=element_text(size=8, vjust = -2),
                    text=element_text(color='gray25', size = 13),
                    panel.background = element_rect(fill='white'),
                    axis.ticks.y=element_blank(),
                    axis.line.x=element_line(color='black'))

box5 = box4 + scale_y_continuous(breaks=seq(0,100, 10),
                                         limits=c(0,100)) + scale_x_discrete(limits=c('Wave','GorgeNet','CenturyLink'))

box5
```

```{r message=FALSE, warning=FALSE}

box1 = ggplot(Internet, aes(x= ISP, y = Upload.Speed)) 

box2 = box1 + geom_boxplot(color='black',fill='white',
                           outlier.color='black',
                           outlier.size=2) + coord_flip()

box3 = box2 + labs(title='Wave provides highest range of upload speeds', subtitle = 'Stevenson, WA',
                   y = 'Upload Speed (Megabytes/Second)',
                   x = NULL,
                   caption = 'Source: Stevenson Business and Organization Internet Survey')

box4 = box3 + theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5)),
                    plot.caption=element_text(size=8, vjust=-2),
                    text=element_text(color='gray25', size = 13),
                    panel.background = element_rect(fill='white'),
                    axis.ticks.y=element_blank(),
                    axis.line.x=element_line(color='black'))

box5 = box4 + scale_y_continuous(breaks=seq(0,100, 10),
                                         limits=c(0,100)) + scale_x_discrete(limits=c('Wave','GorgeNet','CenturyLink'))

box5
```


### Bivariate plots


```{r message= FALSE, warning = FALSE}
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet.RData'
load(file=url(link))
library(ggplot2)

ISP <- factor(Internet$ISP)
str(ISP)
levels(ISP)

#original dataframe w/ all ISPs
df1 <- data.frame(ISP, Internet$Subscribed.Speed, Internet$Download.Speed, Internet$Upload.Speed)
names(df1) <- c("ISP", "Subscribed", "Download", "Upload")

#subsetting the data to only include Wave CL and GorgeNet
df2 <- subset(df1, ISP %in% c("Wave", "CenturyLink", "GorgeNet"))

base = ggplot(df2, aes(x=Subscribed, y=Upload))

box1 = base + geom_point()

box2 = box1 + geom_abline(a=0,b=45,lty=2,lwd=0.5, alpha = 0.5)

box3 = box2 + facet_wrap( ~ ISP ,nrow = 1)

box4 = box3 + scale_y_continuous(breaks=c(0,0,40,60,80,100,120),
                                 limits = c(0, 120))

box5 = box4 + scale_x_continuous(breaks=c(0,30,60,90,120,150),
                                 limits = c(0, 150))

Title = 'GorgeNet Provides the Most Accurate Advertised Upload Speeds'

box6 = box5 + labs(title=Title, subtitle = 'Stevenson, WA',
                   x= 'Suscribed Speed (Megabytes/Second)',
                   y = 'Upload Speed (Megabytes/Second)',
                   caption='Source: Stevenson Business and Organization Internet Survey') + theme_bw()

box7 = box6 + theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=8, vjust=-2),
                    text=element_text(color='gray25', size = 11),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.text=element_text(size=8))
box7
```

```{r message= FALSE, warning = FALSE}
base = ggplot(df2, aes(x=Subscribed, y=Download))

box1 = base + geom_point()

box2 = box1 + geom_abline(a=0,b=45,lty=2,lwd=0.5, alpha = 0.5)

box3 = box2 + facet_wrap( ~ ISP ,nrow = 1)

box4 = box3 + scale_y_continuous(breaks=seq(0,120,20),
                                 limits = c(0,120))

box5 = box4 + scale_x_continuous(breaks=seq(0,120,40),
                                 limits = c(0,120))
Title = 'GorgeNet Provides the Most Accurate Advertised Download Speeds'

box6 = box5 + labs(title=Title, subtitle = 'Stevenson, WA',
                   x= 'Suscribed Speed (Mbps)',
                   y = 'Download Speed (Mbps)',
                   caption='Source: Stevenson Business and Organization Internet Survey
                   Note: Wave Outlier of 500 Mbps Omitted') + theme_bw()

box7 = box6 + theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=8, vjust=-3),
                    text=element_text(color='gray25', size = 11),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.text=element_text(size=8),
                    axis.text.x = element_text(angle = 0, vjust = 0.7),
                    axis.title.x = element_text(vjust = -2, size = 10),
                    axis.title.y = element_text(size = 10, vjust = 2.5))
box7
```


### Multivariate Plots

```{r echo=FALSE, results='hide',message=FALSE}
# loading the data source and opening libraries
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet2.RData'
load(file=url(link))
library(ggplot2)
str(Internet2)
```

```{r message= FALSE, warning = FALSE}
library(dotwhisker)
library(broom)
library(dplyr)

# creating first model of regression for Download and Upload Speeds on Satisfaction with Speed
model1=lm(Satisfaction.Speed~Download.Speed+Upload.Speed,data=Internet2[,-1])
summary(model1)

# tidying up and mutating model of regression
model1_t = tidy(model1) %>% mutate(model = "Model 1") %>%
   relabel_predictors(Upload.Speed = "Upload",
                     Download.Speed = "Download",
                     Subscribed.Speed = "Subscribed")
```

```{r message= FALSE, warning = FALSE}
# creating second model of regression, this time with Subscribed Speeds 
model2=lm(Satisfaction.Speed~Download.Speed+Upload.Speed+Subscribed.Speed,data=Internet2[,-1]) # ~. means: all the remaining variables
summary(model2)

# tidying up and mutating second model of regression 
model2_t <- tidy(model2) %>% mutate(model = "Model 2") %>%
   relabel_predictors(Upload.Speed = "Upload",
                     Download.Speed = "Download",
                     Subscribed.Speed = "Subscribed")
```

```{r message= FALSE, warning = FALSE}
# combining models 
allModels=rbind(model1_t, model2_t)

#plotting
dwplot(allModels) 
```

```{r message= FALSE, warning = FALSE}
# plotting models and adding/changing theme/text elements 
dwplot(allModels) + 
  geom_vline(xintercept = 0, 
               colour = "green", 
               linetype = 2) + 
  scale_colour_grey(start = .1, end = .7) + 
  labs(y = "Independent Variables",
title = "Relationship Between Speed Satisfaction & 
Download, Upload, and Subscribed Speed", 
         caption = "Source:Stevenson Business and Organization Internet Survey") +
  theme(plot.margin=unit(c(1,1,.5,.5),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0.5)),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=9, vjust=-2),
                    text=element_text(color='black', size = 11),
                    legend.title = element_blank(),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.text=element_text(size=8))
```

```{r message= FALSE, warning = FALSE}
##Heatmap

library(scales)
library(ggplot2)

#loading data
link='https://github.com/marcevl/Team-Assignments/raw/master/Internet2.RData'
load(file=url(link))

#changing download speed to a variable from 0-1
Internet2$Download.Speed.Rescaled <- rescale(Internet2$Download.Speed)

#adding data to data frame
df1 <- Internet2

#removing obervation with outlier
df1 <- df1[-3,]

#removing unnecessary variables from heatmap data frame
df.heatmap <- df1[c(2,6,10,40)]

#removing ISPs without many observations
df.heatmap <- subset(df.heatmap, ISP %in% c("Wave", "CenturyLink", "GorgeNet"))

#plotting heat map
heat1 = ggplot(data = df.heatmap, aes(x = Satisfaction.Speed, y = ISP)) +
  geom_tile(aes(fill = Download.Speed.Rescaled))

heat1 = heat1 + labs(title='Satisfaction with ISP not correlated with Download Speed',
            y=NULL,
            x='Satisfaction rating',
            caption='Source: Stevenson Business and Organization Internet Survey',
            fill='Range of \nDownload Speeds')

heat2 = heat1 + theme(plot.margin=unit(c(.5,1,1,1),'cm'),
                    plot.title=(element_text(face='bold',
                                            size=15,
                                            hjust=0,
                                margin=unit(c(0,0,.5,0),'cm'))),
                    plot.subtitle = (element_text(hjust = 0.5, vjust = 2)),
                    plot.caption=element_text(size=8, hjust=2),
                    legend.text=element_blank(),
                    legend.background=element_rect(linetype='solid',
                                                   color='black'),
                    panel.background=element_rect(fill='white'),
                    text=element_text(color='gray25', size = 11),
                    axis.line.y=element_line(color = 'black'),
                    axis.line.x=element_line(color='black'),
                    axis.ticks=element_blank(),
                    axis.text=element_text(size=8))

heat2 + scale_fill_gradient(low='lightblue',high='navy',
                            guide_colorbar(reverse=TRUE,
                                           title='Download Speed'))
```